package net.shyshkin.study.kafka.consumer.converters;

import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;

class GsonTwitterIdExtractorTest {

    @Test
    void extractTest() {
        //given
        String tweetJson = "{\"created_at\":\"Mon Jul 12 09:07:37 +0000 2021\",\"id\":1414511753971568643,\"id_str\":\"1414511753971568643\",\"text\":\"RT @scotsunsport: Scotland fan enjoys last laugh over @rioferdy5 after England's Euro 2020 heartache against Italy\\n\\nhttps:\\/\\/t.co\\/p13IC4M9P8\\u2026\",\"source\":\"\\u003ca href=\\\"https:\\/\\/about.twitter.com\\/products\\/tweetdeck\\\" rel=\\\"nofollow\\\"\\u003eTweetDeck\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":20583090,\"id_str\":\"20583090\",\"name\":\"The Scottish Sun\",\"screen_name\":\"ScottishSun\",\"location\":\"Glasgow, UK\",\"url\":\"http:\\/\\/www.thescottishsun.co.uk\",\"description\":\"The home of The Scottish Sun on Twitter bringing you the latest news, showbiz and sport\",\"translator_type\":\"none\",\"protected\":false,\"verified\":true,\"followers_count\":56061,\"friends_count\":940,\"listed_count\":522,\"favourites_count\":706,\"statuses_count\":264139,\"created_at\":\"Wed Feb 11 11:10:40 +0000 2009\",\"utc_offset\":null,\"time_zone\":null,\"geo_enabled\":true,\"lang\":null,\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"FFFFFF\",\"profile_background_image_url\":\"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_image_url_https\":\"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_tile\":false,\"profile_link_color\":\"0084B4\",\"profile_sidebar_border_color\":\"FFFFFF\",\"profile_sidebar_fill_color\":\"DDEEF6\",\"profile_text_color\":\"242124\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/1407462523599720453\\/ou1M_nwN_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/1407462523599720453\\/ou1M_nwN_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/20583090\\/1623689484\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"withheld_in_countries\":[]},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"retweeted_status\":{\"created_at\":\"Mon Jul 12 09:05:22 +0000 2021\",\"id\":1414511190705836034,\"id_str\":\"1414511190705836034\",\"text\":\"Scotland fan enjoys last laugh over @rioferdy5 after England's Euro 2020 heartache against Italy\\u2026 https:\\/\\/t.co\\/1C0RqaNDTl\",\"display_text_range\":[0,140],\"source\":\"\\u003ca href=\\\"https:\\/\\/www.echobox.com\\\" rel=\\\"nofollow\\\"\\u003eEchobox\\u003c\\/a\\u003e\",\"truncated\":true,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":390042363,\"id_str\":\"390042363\",\"name\":\"Scottish Sun Sport\",\"screen_name\":\"scotsunsport\",\"location\":\"Glasgow, Scotland\",\"url\":\"http:\\/\\/thescottishsun.co.uk\\/football\",\"description\":\"We'll be back \\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc73\\udb40\\udc63\\udb40\\udc74\\udb40\\udc7f #EURO2020 #YesSirICanBoogie Also on Facebook: http:\\/\\/facebook.com\\/ScottishSunSport\",\"translator_type\":\"none\",\"protected\":false,\"verified\":true,\"followers_count\":38256,\"friends_count\":385,\"listed_count\":277,\"favourites_count\":169,\"statuses_count\":174357,\"created_at\":\"Thu Oct 13 11:22:53 +0000 2011\",\"utc_offset\":null,\"time_zone\":null,\"geo_enabled\":true,\"lang\":null,\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"C0DEED\",\"profile_background_image_url\":\"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_image_url_https\":\"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_tile\":false,\"profile_link_color\":\"2D868E\",\"profile_sidebar_border_color\":\"FFFFFF\",\"profile_sidebar_fill_color\":\"DDEEF6\",\"profile_text_color\":\"333333\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/1407625955913392129\\/4nrrpWzN_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/1407625955913392129\\/4nrrpWzN_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/390042363\\/1623690607\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"withheld_in_countries\":[]},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"extended_tweet\":{\"full_text\":\"Scotland fan enjoys last laugh over @rioferdy5 after England's Euro 2020 heartache against Italy\\n\\nhttps:\\/\\/t.co\\/p13IC4M9P8 https:\\/\\/t.co\\/NTDoIipCWl\",\"display_text_range\":[0,121],\"entities\":{\"hashtags\":[],\"urls\":[{\"url\":\"https:\\/\\/t.co\\/p13IC4M9P8\",\"expanded_url\":\"https:\\/\\/www.thescottishsun.co.uk\\/sport\\/football\\/7389526\\/scotland-rio-ferdinand-england-euro-2020-italy\\/?utm_medium=Social&utm_source=Twitter#Echobox=1626080721\",\"display_url\":\"thescottishsun.co.uk\\/sport\\/football\\u2026\",\"indices\":[98,121]}],\"user_mentions\":[{\"screen_name\":\"rioferdy5\",\"name\":\"Rio Ferdinand\",\"id\":155927976,\"id_str\":\"155927976\",\"indices\":[36,46]}],\"symbols\":[],\"media\":[{\"id\":1414511188357046274,\"id_str\":\"1414511188357046274\",\"indices\":[122,145],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/media\\/E6FabnDWYAIMdjL.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/media\\/E6FabnDWYAIMdjL.jpg\",\"url\":\"https:\\/\\/t.co\\/NTDoIipCWl\",\"display_url\":\"pic.twitter.com\\/NTDoIipCWl\",\"expanded_url\":\"https:\\/\\/twitter.com\\/scotsunsport\\/status\\/1414511190705836034\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"small\":{\"w\":680,\"h\":453,\"resize\":\"fit\"},\"medium\":{\"w\":1200,\"h\":800,\"resize\":\"fit\"},\"large\":{\"w\":1200,\"h\":800,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":1414511188357046274,\"id_str\":\"1414511188357046274\",\"indices\":[122,145],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/media\\/E6FabnDWYAIMdjL.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/media\\/E6FabnDWYAIMdjL.jpg\",\"url\":\"https:\\/\\/t.co\\/NTDoIipCWl\",\"display_url\":\"pic.twitter.com\\/NTDoIipCWl\",\"expanded_url\":\"https:\\/\\/twitter.com\\/scotsunsport\\/status\\/1414511190705836034\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"small\":{\"w\":680,\"h\":453,\"resize\":\"fit\"},\"medium\":{\"w\":1200,\"h\":800,\"resize\":\"fit\"},\"large\":{\"w\":1200,\"h\":800,\"resize\":\"fit\"}}}]}},\"quote_count\":0,\"reply_count\":0,\"retweet_count\":2,\"favorite_count\":1,\"entities\":{\"hashtags\":[],\"urls\":[{\"url\":\"https:\\/\\/t.co\\/1C0RqaNDTl\",\"expanded_url\":\"https:\\/\\/twitter.com\\/i\\/web\\/status\\/1414511190705836034\",\"display_url\":\"twitter.com\\/i\\/web\\/status\\/1\\u2026\",\"indices\":[98,121]}],\"user_mentions\":[{\"screen_name\":\"rioferdy5\",\"name\":\"Rio Ferdinand\",\"id\":155927976,\"id_str\":\"155927976\",\"indices\":[36,46]}],\"symbols\":[]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\"},\"is_quote_status\":false,\"quote_count\":0,\"reply_count\":0,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[],\"urls\":[{\"url\":\"https:\\/\\/t.co\\/p13IC4M9P8\",\"expanded_url\":\"https:\\/\\/www.thescottishsun.co.uk\\/sport\\/football\\/7389526\\/scotland-rio-ferdinand-england-euro-2020-italy\\/?utm_medium=Social&utm_source=Twitter#Echobox=1626080721\",\"display_url\":\"thescottishsun.co.uk\\/sport\\/football\\u2026\",\"indices\":[116,139]}],\"user_mentions\":[{\"screen_name\":\"scotsunsport\",\"name\":\"Scottish Sun Sport\",\"id\":390042363,\"id_str\":\"390042363\",\"indices\":[3,16]},{\"screen_name\":\"rioferdy5\",\"name\":\"Rio Ferdinand\",\"id\":155927976,\"id_str\":\"155927976\",\"indices\":[54,64]}],\"symbols\":[]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\",\"timestamp_ms\":\"1626080857161\"}\n";
        TwitterIdExtractor idExtractor = new GsonTwitterIdExtractor();

        //when
        String extractedId = idExtractor.extract(tweetJson);

        //then
        assertThat(extractedId).isEqualTo("1414511753971568643");
    }
}